# Мониторинг ДТП через Яндекс.Карты

Telegram бот для мониторинга дорожно-транспортных происшествий в реальном времени с использованием Яндекс.Карт.

## Функциональность

- Автоматический мониторинг ДТП в заданной области
- Уведомления в Telegram о новых и завершившихся ДТП
- Поддержка множества пользователей
- Сохранение состояния между запусками

## Установка

1. Клонируйте репозиторий:
```bash
git clone <URL репозитория>
cd <папка проекта>
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` в корне проекта:
```env
YANDEX_MAPS_API_KEY=ваш_ключ_яндекс_api
TG_API_KEY=ваш_telegram_bot_token
```

4. Запустите бота:
```bash
python main.py
```

## Настройка

### Параметры командной строки:
- `--lat_min` - минимальная широта (по умолчанию: 55.55)
- `--lon_min` - минимальная долгота (по умолчанию: 37.35)  
- `--lat_max` - максимальная широта (по умолчанию: 55.91)
- `--lon_max` - максимальная долгота (по умолчанию: 37.85)
- `--zoom` - уровень масштабирования (по умолчанию: 11)
- `--interval` - интервал проверки в секундах (по умолчанию: 15)

### Пример запуска с параметрами:
```bash
python main.py --lat_min 55.60 --lon_min 37.40 --lat_max 55.80 --lon_max 37.70 --interval 30
```

## Использование

1. Найдите бота в Telegram по имени
2. Отправьте команду `/start` для подписки на уведомления
3. Получайте автоматические уведомления о ДТП

## Получение API ключей

### Яндекс.Карты API:
1. Перейдите на [Developer Console Яндекс](https://developer.tech.yandex.ru/)
2. Зарегистрируйте новое приложение
3. Получите API ключ для сервисов Яндекс.Карт

### Telegram Bot Token:
1. Найдите @BotFather в Telegram
2. Используйте команду `/newbot` для создания бота
3. Скопируйте полученный токен

## Структура файлов

- `main.py` - основной код приложения
- `accidents.json` - история ДТП (создается автоматически)
- `users.json` - список подписчиков (создается автоматически)
- `.env` - файл с ключами API (создать вручную)

## Технические особенности

- Использует API векторных тайлов Яндекс.Карт, которые вызываются при отображении карт
- Асинхронная обработка запросов
- Фильтрация событий по географическим границам
- Поддержка вложенных event loop для совместимости

## Важно

- Проект использует те же API endpoints, что и публичные Яндекс.Карты, но они незадокументированы
- Проект предназначен для образовательных целей
- Убедитесь, что ваше использование соответствует [условиям использования Яндекс](https://yandex.ru/legal/maps_api/)
- Соблюдайте разумные интервалы запросов